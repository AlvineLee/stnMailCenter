# STN MailCenter 시스템 설계 보고서

## 📋 목차
1. [프로젝트 개요](#프로젝트-개요)
2. [시스템 아키텍처](#시스템-아키텍처)
3. [데이터베이스 설계](#데이터베이스-설계)
4. [프로그램 설계](#프로그램-설계)
5. [주요 기능](#주요-기능)
6. [개발 일정](#개발-일정)
7. [기술 스택](#기술-스택)
8. [예상 비용](#예상-비용)

---

## 🎯 프로젝트 개요

### **프로젝트명**
STN MailCenter - 통합 주문접수 및 다단계 관리 시스템

### **프로젝트 목표**
- 24개 서비스 타입의 통합 주문접수 시스템 구축
- 고객사 계층 구조 관리 (본점-지사-대리점)
- 나도사장 다단계 시스템 (3단계 제한)
- 입점관리 및 계약업체 관리
- API 연동을 통한 외부 시스템 통합

### **핵심 가치**
- **확장성**: 새로운 서비스 타입 쉽게 추가
- **유연성**: 고객사별 서비스 권한 개별 관리
- **안정성**: 다단계법 준수 및 3단계 제한
- **통합성**: 단일 시스템으로 모든 업무 처리

---

## 🏗️ 시스템 아키텍처

### **전체 시스템 구조도**
```
┌─────────────────────────────────────────────────────────────┐
│                    STN MailCenter System                    │
├─────────────────────────────────────────────────────────────┤
│  Frontend (Web UI)                                          │
│  ├── 사용자 인터페이스 (React/Vue.js)                        │
│  ├── 관리자 대시보드                                         │
│  └── 모바일 반응형 UI                                        │
├─────────────────────────────────────────────────────────────┤
│  Backend (CodeIgniter 4)                                    │
│  ├── API 서버                                               │
│  ├── 인증/권한 관리                                          │
│  ├── 비즈니스 로직                                          │
│  └── 파일 업로드 처리                                        │
├─────────────────────────────────────────────────────────────┤
│  Database (MySQL 8.0)                                       │
│  ├── 주문 데이터                                             │
│  ├── 사용자/고객사 데이터                                    │
│  ├── 나도사장 데이터                                         │
│  └── 시스템 설정 데이터                                      │
├─────────────────────────────────────────────────────────────┤
│  External APIs                                              │
│  ├── SMS 발송 API                                           │
│  ├── 이메일 발송 API                                         │
│  ├── 푸시 알림 API                                          │
│  └── 외부 배송업체 API                                       │
└─────────────────────────────────────────────────────────────┘
```

### **사용자 계층 구조**
```
                    시스템 관리자 (Super Admin)
                           │
        ┌──────────────────┼──────────────────┐
        │                  │                  │
    본점 관리자         지사 관리자         대리점 관리자
    (Head Office)      (Branch)           (Agency)
        │                  │                  │
    ┌───┴───┐          ┌───┴───┐          ┌───┴───┐
    │       │          │       │          │       │
  일반사용자  나도사장   일반사용자  나도사장   일반사용자  나도사장
```

### **나도사장 계층 구조 (3단계 제한)**
```
                    Level 1 (본점급)
                           │
                    Level 2 (지사급)
                           │
                    Level 3 (대리점급)
                           │
                    [더 이상 확장 불가]
```

---

## 🗄️ 데이터베이스 설계

### **테이블 구성 (총 32개 테이블)**

#### **1. 핵심 비즈니스 테이블 (7개)**
- `service_types` - 서비스 타입 마스터
- `orders` - 주문 기본 정보
- `orders_quick` - 퀵 서비스 전용 데이터
- `orders_parcel` - 택배 서비스 전용 데이터
- `orders_life` - 생활 서비스 전용 데이터
- `orders_general` - 일반 서비스 전용 데이터
- `orders_special` - 해외/연계 서비스 전용 데이터

#### **2. 사용자/고객사 관리 (3개)**
- `customer_hierarchy` - 고객사 계층 구조
- `users` - 사용자 정보
- `customer_service_permissions` - 고객사별 서비스 권한

#### **3. 나도사장 시스템 (6개)**
- `boss_registration_requests` - 나도사장 신청
- `boss_accounts` - 나도사장 계정
- `boss_contractors` - 하위 계약업체
- `boss_commissions` - 수수료 관리
- `boss_performance` - 실적 관리
- `boss_notifications` - 나도사장 알림

#### **4. 입점 관리 (5개)**
- `store_registration_requests` - 입점 신청
- `store_evaluation` - 입점 심사 평가
- `store_contracts` - 입점 계약
- `store_performance` - 입점 실적
- `store_settlements` - 입점 정산

#### **5. API 연동 (3개)**
- `api_integrations` - API 연동 설정
- `api_integration_logs` - API 연동 로그
- `order_api_status` - 주문 API 전송 상태

#### **6. 알림 시스템 (6개)**
- `notification_channels` - 알림 채널
- `notification_templates` - 알림 템플릿
- `notification_queue` - 알림 큐
- `notification_logs` - 알림 발송 로그
- `user_notification_settings` - 사용자 알림 설정
- `notification_sessions` - 실시간 알림 세션

#### **7. 시스템 관리 (2개)**
- `system_settings` - 시스템 설정
- `store_notifications` - 입점 알림

### **데이터베이스 특징**
- **FK 없는 고성능 설계**: 인덱스만으로 성능 최적화
- **서비스별 전용 테이블**: 확장성과 성능 균형
- **JSON 필드 활용**: 유연한 데이터 저장
- **3단계 제한 함수**: 다단계법 준수

---

## 💻 프로그램 설계

### **MVC 아키텍처 (CodeIgniter 4)**

#### **Controller 구조**
```
Controllers/
├── Auth.php              # 인증 관리
├── Dashboard.php         # 대시보드
├── Orders.php            # 주문 관리
├── Boss.php              # 나도사장 관리
├── Store.php             # 입점 관리
├── Customer.php          # 고객사 관리
├── Admin.php             # 시스템 관리
├── Api.php               # API 연동
└── Notification.php      # 알림 관리
```

#### **Model 구조**
```
Models/
├── UserModel.php         # 사용자 관리
├── OrderModel.php        # 주문 관리
├── BossModel.php         # 나도사장 관리
├── StoreModel.php        # 입점 관리
├── CustomerModel.php     # 고객사 관리
├── NotificationModel.php # 알림 관리
└── ApiModel.php          # API 연동
```

#### **View 구조**
```
Views/
├── layouts/
│   ├── app.php           # 기본 레이아웃
│   ├── admin.php         # 관리자 레이아웃
│   └── boss.php          # 나도사장 레이아웃
├── components/
│   ├── forms/            # 공통 폼 컴포넌트
│   ├── tables/           # 데이터 테이블
│   └── modals/           # 모달 컴포넌트
├── orders/               # 주문 관련 뷰
├── boss/                 # 나도사장 관련 뷰
├── store/                # 입점 관련 뷰
└── admin/                # 관리자 관련 뷰
```

### **핵심 서비스 클래스**
```php
Services/
├── NotificationService.php    # 알림 발송 서비스
├── CommissionService.php      # 수수료 계산 서비스
├── PermissionService.php      # 권한 관리 서비스
├── ApiIntegrationService.php  # API 연동 서비스
└── ReportService.php          # 리포트 생성 서비스
```

---

## 🚀 주요 기능

### **1. 주문 접수 시스템**
- **24개 서비스 타입** 지원
- **공통 폼 + 서비스별 특화 폼** 구조
- **실시간 주문 상태** 추적
- **API 연동**을 통한 외부 시스템 전송

### **2. 고객사 계층 관리**
- **본점-지사-대리점** 3단계 계층 구조
- **계층별 권한** 및 메뉴 제어
- **서비스별 권한** 개별 설정
- **일일/월간 주문 수** 제한

### **3. 나도사장 시스템**
- **3단계 제한** (다단계법 준수)
- **다양한 수수료 타입** (직접판매, 하위라인, 모집보너스)
- **실시간 수수료 계산** 및 지급
- **하위 계약업체** 관리

### **4. 입점 관리**
- **입점 신청** 및 심사 평가
- **계약 관리** 및 실적 추적
- **정산 시스템** (월별/분기별)
- **성과 평가** 및 등급 관리

### **5. 알림 시스템**
- **다중 채널** 지원 (이메일, SMS, 푸시, 앱내)
- **템플릿 기반** 알림 발송
- **실시간 알림** (WebSocket)
- **사용자별 알림 설정**

### **6. API 연동**
- **외부 배송업체** API 연동
- **주문 데이터** 자동 전송
- **상태 동기화** 및 추적
- **에러 처리** 및 재시도 로직

---

## 📅 개발 일정

### **Phase 1: 기본 기능 (3주)**
- [ ] 데이터베이스 구축
- [ ] 로그인/회원가입 시스템
- [ ] 기본 대시보드
- [ ] 주문 접수 (10개 서비스)

### **Phase 2: 사용자 관리 (2주)**
- [ ] 고객사 계층 관리
- [ ] 사용자 권한 관리
- [ ] 서비스 권한 설정

### **Phase 3: 나도사장 시스템 (4주)**
- [ ] 나도사장 신청/승인
- [ ] 수수료 계산 시스템
- [ ] 하위 라인 관리
- [ ] 실적 관리

### **Phase 4: 입점 관리 (3주)**
- [ ] 입점 신청/심사
- [ ] 계약 관리
- [ ] 정산 시스템

### **Phase 5: 고급 기능 (3주)**
- [ ] API 연동
- [ ] 알림 시스템
- [ ] 통계/리포트
- [ ] 시스템 최적화

**총 개발 기간: 15주 (약 4개월)**

---

## 🛠️ 기술 스택

### **Backend**
- **Framework**: CodeIgniter 4
- **Database**: MySQL 8.0
- **Server**: Apache/Nginx
- **PHP**: 8.1+

### **Frontend**
- **CSS Framework**: Tailwind CSS
- **JavaScript**: Vanilla JS + Alpine.js
- **Icons**: Heroicons
- **Charts**: Chart.js

### **External Services**
- **SMS**: 네이버 클라우드 플랫폼
- **Email**: SMTP (Gmail/Naver)
- **Push**: FCM (Firebase)
- **File Storage**: Local/Cloud Storage

### **Development Tools**
- **Version Control**: Git
- **Package Manager**: Composer
- **Testing**: PHPUnit
- **Documentation**: Markdown

---

## 💰 예상 비용

### **개발 비용**
- **개발자**: 1명 × 4개월 = 4인월
- **디자이너**: 0.5인월 (UI/UX)
- **테스터**: 0.5인월
- **총 개발 비용**: 5인월

### **인프라 비용 (월)**
- **서버**: 50,000원 (VPS)
- **데이터베이스**: 30,000원 (RDS)
- **SMS**: 10,000원 (예상)
- **이메일**: 5,000원
- **총 월 인프라 비용**: 95,000원

### **운영 비용 (연)**
- **인프라**: 1,140,000원
- **유지보수**: 2,000,000원
- **총 연 운영 비용**: 3,140,000원

---

## 📊 기대 효과

### **비즈니스 효과**
- **업무 효율성** 50% 향상
- **고객 만족도** 증가
- **수수료 수익** 증대
- **시스템 통합** 비용 절감

### **기술적 효과**
- **확장 가능한** 아키텍처
- **유지보수** 용이성
- **보안성** 강화
- **성능** 최적화

### **운영 효과**
- **실시간 모니터링** 가능
- **자동화된** 프로세스
- **데이터 기반** 의사결정
- **규정 준수** 보장

---

## 🎯 결론

STN MailCenter 시스템은 **확장성**, **유연성**, **안정성**을 핵심으로 하는 통합 주문접수 및 다단계 관리 시스템입니다.

### **핵심 장점**
1. **24개 서비스 타입** 통합 관리
2. **3단계 제한** 다단계 시스템
3. **고객사별 권한** 개별 관리
4. **API 연동** 외부 시스템 통합
5. **실시간 알림** 시스템

### **성공 요인**
- 체계적인 데이터베이스 설계
- 확장 가능한 아키텍처
- 사용자 중심의 UI/UX
- 단계별 개발 전략

이 시스템을 통해 STN의 모든 주문접수 업무를 통합하고, 나도사장 시스템을 통해 수익을 증대시킬 수 있을 것입니다.

---

**문서 작성일**: 2025년 9월
**작성자**: 개발팀
**문서 버전**: 1.0
